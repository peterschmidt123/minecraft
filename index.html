<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Escape Room: Minecraft Zlomky</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #f2f2f2;
      background: url('assets/minecraft.jpg') center/cover no-repeat;
      position: relative;
      transition: background-image 1s ease-in-out;
    }
    .overlay {
      background: rgba(0,0,0,0.6);
      position: absolute; top: 0; left: 0;
      width: 100%; height: 100%; z-index: 0;
    }
    .container {
      position: relative; z-index: 1;
      max-width: 800px; margin: 3rem auto;
      padding: 2rem; background: rgba(44,62,80,0.85);
      border-radius: 12px; box-shadow: 0 0 20px rgba(0,0,0,0.7);
      animation: fadeIn 1s;
    }
    h1, h2 { color: #00ccff; margin-bottom: 1rem; }
    p, pre { margin-bottom: 1rem; line-height: 1.5; white-space: pre-wrap; }
    input[type=text] {
      padding: 0.6rem; width: calc(50% - 1rem);
      margin-right: 1rem; border-radius: 6px; border: 1px solid #ccc;
      font-size: 1rem;
    }
    .start-btn, .next-btn, .mute-btn {
      background: #00ccff; color: #1a1a1a;
      border: none; border-radius: 6px;
      padding: 0.6rem 1.2rem; cursor: pointer;
      margin-top: 1rem; font-size: 1rem;
      transition: transform .2s;
    }
    .start-btn:hover, .next-btn:hover, .mute-btn:hover { transform: scale(1.05); }
    .mute-btn {
      position: fixed; top: 10px; right: 10px; z-index: 2;
    }
    #timer { margin-top: 1rem; font-weight: bold; }
    @keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
    .hidden { display: none !important; }

    /* Mini-game štýly */
    .mine-block {
      width: 100px; height: 100px;
      background: url('assets/diamond_block.png') center/contain no-repeat;
      margin: 1rem auto; cursor: pointer;
    }
    .mine-block.shake {
      animation: shake .3s ease infinite alternate;
    }
    @keyframes shake {
      from { transform: translateX(-3px); }
      to { transform: translateX(3px); }
    }
    .build-grid {
      display: grid;
      grid-template-columns: repeat(4, 60px);
      grid-gap: 8px;
      justify-content: center;
      margin: 1rem 0;
    }
    .build-cell {
      width: 60px; height: 60px;
      background: rgba(255,255,255,0.1);
      border: 2px dashed rgba(255,255,255,0.3);
      cursor: pointer;
      transition: background .3s;
    }
    .build-cell.filled {
      background: url('assets/stone_block.png') center/contain no-repeat;
      border: none;
    }
  </style>
</head>
<body>
  <div class="overlay"></div>

  <!-- Zvuky -->
  <audio id="bg-music" src="music/ambient.mp3" loop></audio>
  <audio id="success-sound" src="music/success.mp3"></audio>
  <audio id="break-sound" src="music/break.mp3"></audio>
  <audio id="place-sound" src="music/place.mp3"></audio>
  <button class="mute-btn">🔊</button>

  <!-- Prológ -->
  <div class="container" id="intro">
    <h1>Prológ: Vtiahnutie do sveta Minecraft</h1>
    <p>
      V škole ste náhodou objavili ukrytý portál, ktorý vás preniesol do neznámeho kúta Minecraftu.
      Okolo vás sa rozprestiera divoký les, nad vami sa blýska tmavá obloha a čoskoro príde noc.
      Vašou jedinou šancou na návrat je postupne plniť matematické úlohy, ktoré aktivujú magické kamene
      v okolí a nakoniec otvoria portál domov.
    </p>
    <button class="start-btn">Začať dobrodružstvo</button>
  </div>

  <!-- Úlohy -->
  <div class="container hidden" id="task-container"></div>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const tasks = [ /* pôvodné definície úloh s miniGame */ ];
      let current = -1, timer, muted = false;
      const intro = document.getElementById('intro');
      const taskContainer = document.getElementById('task-container');
      const bgMusic = document.getElementById('bg-music');
      const successSound = document.getElementById('success-sound');
      const breakSound = document.getElementById('break-sound');
      const placeSound = document.getElementById('place-sound');
      const muteBtn = document.querySelector('.mute-btn');
      const startBtn = document.querySelector('.start-btn');
      startBtn.addEventListener('click', startAdventure);
      muteBtn.addEventListener('click', toggleMute);

      function toggleMute() {
        muted = !muted;
        [bgMusic, successSound, breakSound, placeSound].forEach(a => a.muted = muted);
        muteBtn.textContent = muted ? '🔇' : '🔊';
      }

      function startAdventure() {
        intro.classList.add('hidden');
        bgMusic.play();
        nextTask();
      }

      function nextTask() { /* ... */ }
      function showPortalTransition() { /* ... */ }
      function loadTask() { /* ... */ }
      function checkAnswer() { /* ... */ }
      function celebrateAndContinue() { /* ... */ }
      function showMiniGame(mg) { /* ... */ }
      function finishMiniGame(mg) { /* ... */ }
      function startTimer(sec) { /* ... */ }
      function parseFraction(s) { /* ... */ }
      function finishAdventure() { /* ... */ }
    });
  </script>
</body>
</html>
