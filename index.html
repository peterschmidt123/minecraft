<!DOCTYPE html>
<html lang="sk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Escape Room: Minecraft Zlomky</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Segoe UI',Tahoma,sans-serif;color:#fff;background-size:cover;background-position:center;transition:background-image 1s ease;position:relative;}
    .overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);}
    .container{position:relative;z-index:1;max-width:700px;margin:3rem auto;padding:2rem;background:rgba(0,0,0,0.7);border-radius:10px;}
    h1,h2{color:#79c2ff;margin-bottom:1rem;}
    p{margin-bottom:1rem;line-height:1.4;}
    .btn, .mute{background:#79c2ff;color:#000;border:none;border-radius:5px;padding:0.5rem 1rem;cursor:pointer;transition:transform .2s;font-size:1rem;}
    .btn:hover,.mute:hover{transform:scale(1.05);}
    input{padding:0.5rem;width:calc(50% - 1rem);margin-right:1rem;border-radius:4px;border:none;font-size:1rem;}
    #timer{margin-top:1rem;font-weight:bold;}
    #mini-game{text-align:center;}
    .click-block{width:80px;height:80px;background:url('assets/diamond_block.png')center/contain no-repeat;margin:1rem auto;cursor:pointer;}
  </style>
</head>
<body>
  <div class="overlay"></div>
  <audio id="music" src="music/ambient.mp3" loop autoplay></audio>
  <audio id="win" src="music/success.mp3"></audio>
  <button class="mute" onclick="mute()">üîä</button>
  <div class="container" id="intro">
    <h1>Escape Room: Minecraft Zlomky</h1>
    <p>Ocitli ste sa magicky prenesen√≠ do sveta Minecraft. Noc sa bl√≠≈æi a vy potrebujete pre≈æi≈•: z√≠ska≈• drevo, postavi≈• √∫kryt, upiec≈• jedlo, ≈•a≈æi≈• suroviny a akt√≠vova≈• port√°l domov!</p>
    <button class="btn" onclick="next()">Zaƒça≈• dobrodru≈æstvo</button>
  </div>

  <div class="container hidden" id="task"></nobr>
  </div>

  <script>
    const tasks=[
      {bg:'assets/forest.gif',title:'√öloha 1: Zlomky dreva',context:'Potrebujete ohe≈à a √∫kryt. M√°te 3/4 z√°sob dreva, potrebujete 5/6. Koƒæko v√°m ch√Ωba?','inputs':1,question:'5/6 ‚àí 3/4 = ?',answer:1/12,time:90},
      {bg:'assets/house.gif',title:'√öloha 2: Stavba √∫krytu',context:'√ökryt m√° tvar obdƒ∫≈ænika 8√ó5 blokov. Vypoƒç√≠taj obvod a obsah.',inputs:2,question:'Obvod = ? , Obsah = ?',answer:[26,40],time:120},
      {bg:'assets/diamond_cave.gif',type:'click',title:'Minihra',context:'Klikni na diamantov√Ω blok 5-kr√°t',clicks:5,time:60},
      {bg:'assets/furnace.gif',title:'√öloha 3: Peƒçenie chleba',context:'Chlieb spotrebuje 3/8 m√∫ky, m√°te 5 vrec√∫≈°ok. Koƒæko chleba upiec≈• m√¥≈æete?',inputs:1,question:'5 √∑ (3/8) = ?',answer:13,time:90},
      {bg:'assets/mining.gif',title:'√öloha 4: ≈§a≈æba rudy',context:'Lom 12√ó12 blokov, vy≈•a≈æili ste 5/8 rudy. Koƒæko zostalo?',inputs:1,question:'144√ó(3/8) = ?',answer:54,time:90},
      {bg:'assets/portal.gif',title:'√öloha 5: Port√°l domov',context:'Potrebujete 2/3 z 18 ender per√°l.',inputs:1,question:'2/3√ó18 = ?',answer:12,time:90}
    ];
    let i=-1,tm,score=0,clicks=0,muted=false;
    const cont=document.getElementById('task'),intro=document.getElementById('intro');
    function mute(){muted=!muted;document.getElementById('music').muted=muted;document.querySelector('.mute').textContent=muted?'üîá':'üîä';}
    function next(){i++;if(i===tasks.length){end();return;}render(tasks[i]);}
    function render(t){document.body.style.backgroundImage=`url(${t.bg})`;cont.classList.remove('hidden');intro.classList.add('hidden');
      let html=`<h2>${t.title}</h2><p>${t.context}</p>`;
      if(t.type==='click'){html+=`<div id="mini-game"><div class="click-block" onclick="clk()"></div><p>0 / ${t.clicks}</p></div>`;
      }else{html+=`<p><strong>Ot√°zka:</strong> ${t.question}</p><div>`;
        for(let k=0;k<t.inputs;k++) html+=`<input type="text" id="a${k}" placeholder="odpoveƒè">`;
        html+=`</div><button class="btn" onclick="chk()">Skontrolova≈•</button>`;
      }
      html+=`<div id="feedback"></div><div id="timer"></div>`;cont.innerHTML=html;startTimer(t.time);
    }
    function clk(){clicks++;document.querySelector('#mini-game p').textContent=`${clicks} / ${tasks[i].clicks}`;if(clicks>=tasks[i].clicks){winIt();}}
    function chk(){const t=tasks[i];let ok=true;if(!t.type){for(let k=0;k<t.inputs;k++){const v=parseFloat(document.getElementById('a'+k).value);const ans=Array.isArray(t.answer)?t.answer[k]:t.answer; if(Math.abs(v-ans)>0.01)ok=false;}}if(ok)winIt();else document.getElementById('feedback').textContent='‚ùå Sk√∫s znova';}
    function startTimer(s){clearInterval(tm);let c=s;document.getElementById('timer').textContent=`‚è±Ô∏è ${c}s`;tm=setInterval(()=>{c--;document.getElementById('timer').textContent=`‚è±Ô∏è ${c}s`;if(c<=0){clearInterval(tm);document.getElementById('feedback').textContent='‚õî ƒåas vypr≈°al';}},1000);}
    function winIt(){clearInterval(tm);document.getElementById('feedback').textContent='‚úîÔ∏è Spr√°vne!';document.getElementById('win').play();setTimeout(next,1000);}
    function end(){document.body.style.backgroundImage="url('assets/celebration.gif')";cont.innerHTML=`<h2>üéâ √öspe≈°ne ste unikli! üéâ</h2><p>Vitajte sp√§≈• v ≈°kole.</p>`;}
  </script>
</body>
</html>
